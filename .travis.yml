sudo: required

language: node_js

services:
- docker

branches:
  only:
  - master
  - /^greenkeeper/.*$/

before_install: yarn global add greenkeeper-lockfile@1

before_script: greenkeeper-lockfile-update

script:
- yarn build
- yarn test

after_script: greenkeeper-lockfile-upload

after_success:
- if [ "$TRAVIS_BRANCH" == "master" ]; then
    $TRAVIS_BUILD_DIR/deploy/run.sh ci_deploy_to_test
  fi

cache:
  directories:
  - node_modules
  yarn: true

notifications:
  email: false

notifications:
  slack:
    secure: "$SLACK_TOKEN"
